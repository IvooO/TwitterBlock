{"ast":null,"code":"import _asyncToGenerator from\"/Users/ivovanoverstraeten/Desktop/TwitterBlock/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ivovanoverstraeten/Desktop/TwitterBlock/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/ivovanoverstraeten/Desktop/TwitterBlock/node_modules/@babel/runtime/regenerator/index.js\";import React from\"react\";import\"./Home.css\";import{defaultImgs}from\"../defaultimgs\";import{TextArea,Icon}from\"web3uikit\";import{useState,useRef}from\"react\";import TweetInFeed from\"../components/TweetInFeed\";import{useMoralis,useWeb3ExecuteFunction}from\"react-moralis\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Home=function Home(){var _useMoralis=useMoralis(),Moralis=_useMoralis.Moralis;var user=Moralis.User.current();var contractProcessor=useWeb3ExecuteFunction();var inputFile=useRef(null);var _useState=useState(),_useState2=_slicedToArray(_useState,2),selectedFile=_useState2[0],setSelectedFile=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),theFile=_useState4[0],setTheFile=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tweet=_useState6[0],setTweet=_useState6[1];function maticTweet(){return _maticTweet.apply(this,arguments);}function _maticTweet(){_maticTweet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var img,data,file,options;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(tweet){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(!theFile){_context.next=10;break;}data=theFile;file=new Moralis.File(data.name,data);_context.next=7;return file.saveIPFS();case 7:img=file.ipfs();_context.next=11;break;case 10:img=\"No Img\";case 11:options={contractAddress:\"0xd7e20Ed20f0F4660Fd86351F0bCf45D502d8867f\",functionName:\"addTweet\",abi:[{\"inputs\":[{\"internalType\":\"string\",\"name\":\"tweetTxt\",\"type\":\"string\"},{\"internalType\":\"string\",\"name\":\"tweetImg\",\"type\":\"string\"}],\"name\":\"addTweet\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"}],params:{tweetTxt:tweet,tweetImg:img},msgValue:Moralis.Units.ETH(1)};_context.next=14;return contractProcessor.fetch({params:options,onSuccess:function onSuccess(){saveTweet();},onError:function onError(error){console.log(error.data.message);}});case 14:case\"end\":return _context.stop();}}},_callee);}));return _maticTweet.apply(this,arguments);}function saveTweet(){return _saveTweet.apply(this,arguments);}function _saveTweet(){_saveTweet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var Tweets,newTweet,data,file;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(tweet){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:Tweets=Moralis.Object.extend(\"Tweets\");newTweet=new Tweets();newTweet.set(\"tweetTxt\",tweet);newTweet.set(\"tweeterPfp\",user.attributes.pfp);newTweet.set(\"tweeterAcc\",user.attributes.ethAddress);newTweet.set(\"tweeterUserName\",user.attributes.username);if(!theFile){_context2.next=14;break;}data=theFile;file=new Moralis.File(data.name,data);_context2.next=13;return file.saveIPFS();case 13:newTweet.set(\"tweetImg\",file.ipfs());case 14:_context2.next=16;return newTweet.save();case 16:window.location.reload();case 17:case\"end\":return _context2.stop();}}},_callee2);}));return _saveTweet.apply(this,arguments);}var onImageClick=function onImageClick(){inputFile.current.click();};var changeHandler=function changeHandler(event){var img=event.target.files[0];setTheFile(img);setSelectedFile(URL.createObjectURL(img));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"pageIdentify\",children:\"Home\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mainContent\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profileTweet\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.attributes.pfp?user.attributes.pfp:defaultImgs[0],className:\"profilePic\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"tweetBox\",children:[/*#__PURE__*/_jsx(TextArea,{label:\"\",name:\"tweetTxtArea\",value:\"GM World\",type:\"text\",onChange:function onChange(e){return setTweet(e.target.value);},width:\"95%\"}),selectedFile&&/*#__PURE__*/_jsx(\"img\",{src:selectedFile,className:\"tweetImg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"imgOrTweet\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"imgDiv\",onClick:onImageClick,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",ref:inputFile,onChange:changeHandler,style:{display:\"none\"}}),/*#__PURE__*/_jsx(Icon,{fill:\"#1DA1F2\",size:20,svg:\"image\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tweetOptions\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tweet\",onClick:saveTweet,children:\"Tweet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"tweet\",onClick:maticTweet,style:{backgroundColor:\"#8247e5\"},children:/*#__PURE__*/_jsx(Icon,{fill:\"#ffffff\",size:20,svg:\"matic\"})})]})]})]})]}),/*#__PURE__*/_jsx(TweetInFeed,{profile:false})]})]});};export default Home;","map":{"version":3,"sources":["/Users/ivovanoverstraeten/Desktop/TwitterBlock/src/pages/Home.js"],"names":["React","defaultImgs","TextArea","Icon","useState","useRef","TweetInFeed","useMoralis","useWeb3ExecuteFunction","Home","Moralis","user","User","current","contractProcessor","inputFile","selectedFile","setSelectedFile","theFile","setTheFile","tweet","setTweet","maticTweet","data","file","File","name","saveIPFS","img","ipfs","options","contractAddress","functionName","abi","params","tweetTxt","tweetImg","msgValue","Units","ETH","fetch","onSuccess","saveTweet","onError","error","console","log","message","Tweets","Object","extend","newTweet","set","attributes","pfp","ethAddress","username","save","window","location","reload","onImageClick","click","changeHandler","event","target","files","URL","createObjectURL","e","value","display","backgroundColor"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./Home.css\";\nimport { defaultImgs } from \"../defaultimgs\";\nimport { TextArea, Icon } from \"web3uikit\";\nimport { useState, useRef } from \"react\";\nimport TweetInFeed from \"../components/TweetInFeed\";\nimport { useMoralis, useWeb3ExecuteFunction } from \"react-moralis\";\n\nconst Home = () => {\n\n  const { Moralis } = useMoralis();\n  const user = Moralis.User.current();\n  const contractProcessor = useWeb3ExecuteFunction();\n\n  const inputFile = useRef(null);\n  const [selectedFile, setSelectedFile] = useState();\n  const [theFile, setTheFile] = useState();\n  const [tweet, setTweet] = useState();\n\n  async function maticTweet() {\n\n    if (!tweet) return;\n\n    let img;\n    if (theFile) {\n      const data = theFile;\n      const file = new Moralis.File(data.name, data);\n      await file.saveIPFS();\n      img = file.ipfs();\n    }else{\n      img = \"No Img\"\n    }\n\n    let options = {\n      contractAddress: \"0xd7e20Ed20f0F4660Fd86351F0bCf45D502d8867f\" ,\n      functionName: \"addTweet\",\n      abi: [{\n        \"inputs\": [\n          {\n            \"internalType\": \"string\",\n            \"name\": \"tweetTxt\",\n            \"type\": \"string\"\n          },\n          {\n            \"internalType\": \"string\",\n            \"name\": \"tweetImg\",\n            \"type\": \"string\"\n          }\n        ],\n        \"name\": \"addTweet\",\n        \"outputs\": [],\n        \"stateMutability\": \"payable\",\n        \"type\": \"function\"\n    \n      }],\n      params: {\n        tweetTxt: tweet,\n        tweetImg: img,\n      },\n      msgValue: Moralis.Units.ETH(1),\n    }\n\n    await contractProcessor.fetch({\n      params: options,\n      onSuccess: () => {\n        saveTweet();\n      },\n      onError: (error) => {\n        console.log(error.data.message)\n      }\n    });\n\n  }\n\n\n  async function saveTweet() {\n\n    if(!tweet) return;\n\n    const Tweets = Moralis.Object.extend(\"Tweets\");\n\n    const newTweet = new Tweets();\n\n    newTweet.set(\"tweetTxt\", tweet);\n    newTweet.set(\"tweeterPfp\", user.attributes.pfp);\n    newTweet.set(\"tweeterAcc\", user.attributes.ethAddress);\n    newTweet.set(\"tweeterUserName\", user.attributes.username);\n\n    if (theFile) {\n      const data = theFile;\n      const file = new Moralis.File(data.name, data);\n      await file.saveIPFS();\n      newTweet.set(\"tweetImg\", file.ipfs());\n    }\n\n    await newTweet.save();\n    window.location.reload();\n\n  }\n\n  const onImageClick = () => {\n    inputFile.current.click();\n  };\n\n  const changeHandler = (event) => {\n    const img = event.target.files[0];\n    setTheFile(img);\n    setSelectedFile(URL.createObjectURL(img));\n  };\n\n  return (\n    <>\n    <div className=\"pageIdentify\">Home</div>\n      <div className=\"mainContent\">\n        <div className=\"profileTweet\">\n          <img src={user.attributes.pfp ? user.attributes.pfp : defaultImgs[0]} className=\"profilePic\"></img>\n          <div className=\"tweetBox\">\n            <TextArea\n              label=\"\"\n              name=\"tweetTxtArea\"\n              value=\"GM World\"\n              type=\"text\"\n              onChange={(e) => setTweet(e.target.value)}\n              width=\"95%\"\n            ></TextArea>\n            {selectedFile && (\n              <img src={selectedFile} className=\"tweetImg\"></img>\n            )}\n            <div className=\"imgOrTweet\">\n              <div className=\"imgDiv\" onClick={onImageClick}>\n              <input\n                  type=\"file\"\n                  name=\"file\"\n                  ref={inputFile}\n                  onChange={changeHandler}\n                  style={{ display: \"none\"}}\n                />\n                <Icon fill=\"#1DA1F2\" size={20} svg=\"image\"></Icon>\n              </div>\n              <div className=\"tweetOptions\">\n                <div className=\"tweet\" onClick={saveTweet}>Tweet</div>\n                <div className=\"tweet\" onClick={maticTweet} style={{ backgroundColor: \"#8247e5\" }}>\n                  <Icon fill=\"#ffffff\" size={20} svg=\"matic\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <TweetInFeed profile={false}/>\n      </div>\n    </>\n  );\n};\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}